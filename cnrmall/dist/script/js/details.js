define(["config"],function(){require(["jquery"],function(){require(["cookie"],function(){var i="http://10.31.155.114/1808-5/shenqiuyun/cnrmall/php/",s=location.search.substring(1).split("=")[1];$.ajax({type:"post",async:!0,url:i+"details.php",data:{id:s},dataType:"json"}).done(function(i){$.each(i,function(i,e){s&&$("title").text(e.title);var t=e.urls.split("&");$.each(t,function(i,e){var t='<img src="'+e+'" alt="" title=""/>';$(".imgbox").append(t),$(".imgbox").children("img").eq(0).addClass("active")}),$(".spic,.bf").children("img").attr("src",t[0]),$(".spic img").attr("sid",e.id),$(".location span").text(e.title),$(".enshrine-num").text(e.enshrine),$(".limit-buy").text(e.limit_buy);var o='<div class="goods-title"><h2>'+e.title+"</h2><p>"+e.description+'</p></div><dl class="goods-price-box"><dt>央广价</dt><dd>￥<b>'+e.price+'</b> <em class="original-price">原价：￥<i>'+e.original_price+"</i></em><em>赠送购物金: "+e.give_buy_money+'</em></dd></dl><dl class="logistics"><dt>物流</dt><dd>配送至<div class="delivery-address"><span>浙江杭州市江干区</span><i></i></div><strong class="repertory"><b></b><i></i></strong></dd></dl>';$(".goods-details").prepend(o),0==e.repertory?$(".repertory").find("b").text("无货"):$(".repertory").find("b").text("有货"),0==e.postage?$(".repertory").find("i").text("免运费"):$(".repertory").find("i").html("运费：￥"+e.postage),0==e.sold_out?$(".sold-out").show():$(".buy-number").show();var n=$("#mnBuyNumInput").val();$(".amount .plus").on("click",function(){$(".amount .minus").removeClass("crisis"),++n>e.limit_buy&&($(this).addClass("crisis"),n=e.limit_buy),$("#mnBuyNumInput").val(n)}),$(".amount .minus").on("click",function(){$(".amount .plus").removeClass("crisis"),--n<=1&&($(this).addClass("crisis"),n=1),$("#mnBuyNumInput").val(n)}),$(".imgbox").find("img").size()<=5?$(".spec-list").find("span").hide():$(".spec-list").find("span").show()})}).fail(function(){});var t=[],o=[];function e(){$.ajax({type:"get",url:i+"get_showcase.php",dataType:"json"}).done(function(i){$.each(i,function(i,e){var t=e.urls.split("&"),o='<li><a href="details.html?&id='+e.id+'" target="_blank"><img src="'+t[0]+'" alt="" title="" referrer="no-referrer|origin|unsafe-url"/><p>￥ '+e.price+"</p></a></li>";$(".showcase ul").append(o)})}).fail(function(){console.log("响应失败")})}$(".addcart").on("click",function(){var i=$(".spic").find("img").attr("sid");if($.cookie("cookiesid")&&$.cookie("cookienum")&&(t=$.cookie("cookiesid").split(","),o=$.cookie("cookienum").split(",")),-1!=$.inArray(i,t)){var e=parseInt(o[$.inArray(i,t)])+parseInt($("#mnBuyNumInput").val());o[$.inArray(i,t)]=e,$.cookie("cookienum",o.toString(),{expires:10})}else t.push(i),$.cookie("cookiesid",t.toString(),{expires:10}),o.push($("#mnBuyNumInput").val()),$.cookie("cookienum",o.toString(),{expires:10});$("body").append('<div class="pop-up"><p><i></i>成功加入购物车!</p></div>'),setTimeout(function(){$(".pop-up").remove(),location.reload(!0)},800)}),e(),$(".change").on("click",function(){$(".showcase ul").html(""),e()})})})});